# ç«¯å£é…ç½®è¯´æ˜

## ğŸ“Œ ç«¯å£æ€»ç»“

### å®¹å™¨ç«¯å£ï¼š**8080** (é»˜è®¤)

åº”ç”¨é»˜è®¤ç›‘å¬ **8080** ç«¯å£ï¼Œè¿™æ˜¯ Zeabur å’Œå¤§å¤šæ•°äº‘å¹³å°çš„æ ‡å‡†ç«¯å£ã€‚

### ç«¯å£é…ç½®æ–¹å¼

ç«¯å£é€šè¿‡ç¯å¢ƒå˜é‡ `PORT` é…ç½®ï¼š

```bash
# é»˜è®¤å€¼
PORT=8080

# å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ä¿®æ”¹
docker run -e PORT=3000 ...
```

## ğŸ”§ é…ç½®è¯¦æƒ…

### Dockerfile é…ç½®

```dockerfile
# é»˜è®¤ç«¯å£
ENV PORT=8080

# æš´éœ²ç«¯å£
EXPOSE 8080

# å¯åŠ¨å‘½ä»¤ä½¿ç”¨ç¯å¢ƒå˜é‡
CMD sh -c "uvicorn backend.main:app --host 0.0.0.0 --port ${PORT:-8080}"
```

### å¥åº·æ£€æŸ¥

å¥åº·æ£€æŸ¥ä¹Ÿä½¿ç”¨ `PORT` ç¯å¢ƒå˜é‡ï¼š

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \
  CMD python -c "import os, urllib.request; urllib.request.urlopen(f'http://localhost:{os.getenv(\"PORT\", \"8080\")}/health').read()"
```

## ğŸŒ ä¸åŒç¯å¢ƒçš„ç«¯å£

### 1. Zeabur éƒ¨ç½²

**Zeabur ä¼šè‡ªåŠ¨è®¾ç½® `PORT` ç¯å¢ƒå˜é‡**

- Zeabur é€šå¸¸ä½¿ç”¨ 8080 ç«¯å£
- æ‚¨**ä¸éœ€è¦**æ‰‹åŠ¨è®¾ç½® `PORT` ç¯å¢ƒå˜é‡
- è®¿é—®æ—¶ä½¿ç”¨ Zeabur æä¾›çš„åŸŸåï¼ˆå¦‚ `https://your-app.zeabur.app`ï¼‰
- Zeabur ä¼šè‡ªåŠ¨å¤„ç†ç«¯å£æ˜ å°„å’Œ HTTPS

### 2. æœ¬åœ° Docker æµ‹è¯•

**æ˜ å°„åˆ°æœ¬åœ° 8080 ç«¯å£**

```bash
# Windows
local-test.bat
# è®¿é—®: http://localhost:8080

# Linux/Mac
./local-test.sh
# è®¿é—®: http://localhost:8080
```

**æ‰‹åŠ¨è¿è¡Œ**

```bash
# ä½¿ç”¨é»˜è®¤ç«¯å£ 8080
docker run -p 8080:8080 \
  -e APP_SECRET_KEY=test-key \
  -v ./data:/data \
  tg-signer

# è®¿é—®: http://localhost:8080
```

**ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£**

```bash
# å®¹å™¨å†…ä½¿ç”¨ 3000ï¼Œæ˜ å°„åˆ°æœ¬åœ° 8080
docker run -p 8080:3000 \
  -e PORT=3000 \
  -e APP_SECRET_KEY=test-key \
  -v ./data:/data \
  tg-signer

# è®¿é—®: http://localhost:8080
```

### 3. å…¶ä»–äº‘å¹³å°

ä¸åŒå¹³å°çš„é»˜è®¤ç«¯å£ï¼š

| å¹³å° | é»˜è®¤ç«¯å£ | ç¯å¢ƒå˜é‡ |
|------|---------|---------|
| Zeabur | 8080 | `PORT` |
| Railway | è‡ªåŠ¨åˆ†é… | `PORT` |
| Render | 10000 | `PORT` |
| Heroku | åŠ¨æ€åˆ†é… | `PORT` |
| Fly.io | 8080 | `PORT` |

**æˆ‘ä»¬çš„åº”ç”¨ä¼šè‡ªåŠ¨é€‚é…**ï¼Œå› ä¸ºä½¿ç”¨äº† `${PORT:-8080}`ï¼ˆé»˜è®¤ 8080ï¼Œå¯è¢«ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰

## ğŸ” ç«¯å£æ£€æŸ¥

### æ£€æŸ¥å®¹å™¨ç›‘å¬çš„ç«¯å£

```bash
# æŸ¥çœ‹å®¹å™¨ç«¯å£æ˜ å°„
docker ps

# è¾“å‡ºç¤ºä¾‹:
# PORTS
# 0.0.0.0:8080->8080/tcp
```

### æ£€æŸ¥åº”ç”¨æ—¥å¿—

```bash
docker logs <container_name>

# åº”è¯¥çœ‹åˆ°:
# INFO:     Uvicorn running on http://0.0.0.0:8080
```

### æµ‹è¯•ç«¯å£è¿æ¥

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# è®¿é—®å‰ç«¯
curl http://localhost:8080/

# æµ‹è¯• API
curl http://localhost:8080/api/auth/login
```

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: ç«¯å£å†²çª

**é”™è¯¯**: `Address already in use`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥æ‰¾å ç”¨ 8080 ç«¯å£çš„è¿›ç¨‹
# Windows
netstat -ano | findstr :8080

# Linux/Mac
lsof -i :8080

# ä½¿ç”¨å…¶ä»–ç«¯å£
docker run -p 9000:8080 ...
# è®¿é—®: http://localhost:9000
```

### é—®é¢˜ 2: æ— æ³•è®¿é—®

**æ£€æŸ¥æ¸…å•**:
1. âœ… å®¹å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Ÿ `docker ps`
2. âœ… ç«¯å£æ˜¯å¦æ­£ç¡®æ˜ å°„ï¼Ÿ `docker ps` æŸ¥çœ‹ PORTS åˆ—
3. âœ… é˜²ç«å¢™æ˜¯å¦é˜»æ­¢ï¼Ÿæ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. âœ… ä½¿ç”¨æ­£ç¡®çš„åè®®ï¼Ÿæœ¬åœ°ç”¨ `http://`ï¼ŒZeabur ç”¨ `https://`

### é—®é¢˜ 3: Zeabur éƒ¨ç½²åæ— æ³•è®¿é—®

**æ£€æŸ¥**:
1. âœ… ä¸è¦æ‰‹åŠ¨è®¾ç½® `PORT` ç¯å¢ƒå˜é‡ï¼ˆZeabur ä¼šè‡ªåŠ¨è®¾ç½®ï¼‰
2. âœ… ä½¿ç”¨ Zeabur æä¾›çš„åŸŸåï¼Œä¸æ˜¯ IP:ç«¯å£
3. âœ… ä½¿ç”¨ HTTPS è€Œä¸æ˜¯ HTTP
4. âœ… æ£€æŸ¥ Zeabur æ—¥å¿—ç¡®è®¤åº”ç”¨å¯åŠ¨æˆåŠŸ

## ğŸ“ ç«¯å£é…ç½®æ€»ç»“

### æ¨èé…ç½®

| ç¯å¢ƒ | ç«¯å£æ˜ å°„ | è®¿é—®æ–¹å¼ |
|------|---------|---------|
| **Zeabur** | è‡ªåŠ¨ | `https://your-app.zeabur.app` |
| **æœ¬åœ°æµ‹è¯•** | `-p 8080:8080` | `http://localhost:8080` |
| **è‡ªå®šä¹‰** | `-p <å¤–éƒ¨>:<å†…éƒ¨> -e PORT=<å†…éƒ¨>` | `http://localhost:<å¤–éƒ¨>` |

### ç¯å¢ƒå˜é‡

```bash
# Zeabur - ä¸éœ€è¦è®¾ç½®ï¼Œè‡ªåŠ¨é…ç½®
# æœ¬åœ° - å¯é€‰ï¼Œé»˜è®¤ 8080
PORT=8080

# å¿…é¡»è®¾ç½®
APP_SECRET_KEY=your-secret-key
```

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### æœ¬åœ°æµ‹è¯•ï¼ˆ8080 ç«¯å£ï¼‰

```bash
# æ„å»º
docker build -t tg-signer .

# è¿è¡Œ
docker run -p 8080:8080 \
  -e APP_SECRET_KEY=test-key \
  -v ./data:/data \
  tg-signer

# è®¿é—®
open http://localhost:8080
```

### Zeabur éƒ¨ç½²

```bash
# æäº¤ä»£ç 
git push

# Zeabur ä¼šè‡ªåŠ¨:
# 1. æ„å»ºé•œåƒ
# 2. è®¾ç½® PORT ç¯å¢ƒå˜é‡
# 3. å¯åŠ¨å®¹å™¨
# 4. æä¾› HTTPS åŸŸå

# è®¿é—®
# https://your-app.zeabur.app
```

---

**é»˜è®¤ç«¯å£**: 8080  
**å¯é…ç½®**: æ˜¯ï¼ˆé€šè¿‡ `PORT` ç¯å¢ƒå˜é‡ï¼‰  
**Zeabur å…¼å®¹**: âœ… æ˜¯
